<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no;" />

    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<link rel="stylesheet"  href="http://code.jquery.com/mobile/1.0b3/jquery.mobile-1.0b3.min.css" />
	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
	<script src="http://code.jquery.com/jquery-1.6.2.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.0b3/jquery.mobile-1.0b3.min.js"></script>
	<script type="text/javascript" src="js/ui/min/jquery.ui.map.full.min.js"></script>
	<script type="text/javascript" src="js/ui/jquery.ui.map.extensions.js"></script>
	<script type="text/javascript" src="data/data.js"></script>

    <script>
			////////////////////////////////////////////////////////////

			$('#trail_map').live("pageshow", function() {
					$.each(trail, function(index) {
						var point = trail[index];
						$('#map_canvas_2').gmap('addMarker', { 'html': point.name, 'position': new google.maps.LatLng(point.lat, point.lon), 'bounds': true } );
					});

				$('#map_canvas_2').gmap('refresh');
			});

			$('#trail_map').live("pagecreate", function() {
				$('#map_canvas_2').gmap({'center': '34.62673, -84.193656', 'mapTypeId': 'terrain'}).bind('init', function(evt, map) {
					$('#map_canvas_2').gmap('watchPosition', function(position, status) {
						if ( status === 'OK' ) {
							var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
							var marker = $('#map_canvas_2').gmap('get', 'markers > client' );
							if ( !marker ) {
								$('#map_canvas_2').gmap('addMarker', { 'id': 'client', 'position': latlng, 'bounds': true });
							} else {
								marker.setPosition(latlng);
								map.panTo(latlng);
							}
						}
					});
				});
			});

			$('#trail_map').live("pagehide", function() {
				$('#map_canvas_2').gmap('clearWatch');
			});

			$('#find_a_hotel').live("pageshow", function () {
				$('#map_canvas_3').gmap('refresh');
			});

			$('#find_a_hotel').live("pagecreate", function () {
				$('#map_canvas_3').gmap({'mapTypeId': 'terrain'}).bind('init', function(evt, map) {
					$('#map_canvas_3').gmap('watchPosition', function(position, status) {
						if ( status === 'OK' ) {
							var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
							var marker = $('#map_canvas_3').gmap('get', 'markers > client' );
							if ( !marker ) {
								console.log('marker');
								$('#map_canvas_3').gmap('addMarker', { 'id': 'client', 'position': latlng, 'bounds': true });
							} else {
								console.log('nomarker');
								marker.setPosition(latlng);
								map.panTo(latlng);
							}
						}
					});
				});
			});

			$('#find_a_hotel').live("pagehide", function() {
				$('#map_canvas_3').gmap('clearWatch');
			});
    </script>
  </head>
  <body>
  	  <div data-role="page" id="home">
          <div data-role="header">
              <h1>Appalachian Trail </h1>
          </div>
          <div data-role="content">
              <a id="myPackagesButton" data-role="button">My Packages</a>
              <p/>
              <a href="#trail_map" id="trailMagicButton" data-role="button">Show Map</a>
              <p/>
              <a id="foundTrailMagic" href="#found_trail_magic" data-role="button">Found Trail Magic</a>
              <p/>
              <a id="findAHotel" href="#find_a_hotel" data-role="button">Find a Hotel</a>

          </div>
      </div>

		<div data-title="Trail Map" id="trail_map" data-role="page">
			<div data-role="header" data-add-back-btn="true">
				<h1>Trail Map</h1>
				<a href="index.html" data-ajax="false" data-icon="home">Home</a>
			</div>
			<div data-role="content">
				<div class="ui-bar-c ui-corner-all ui-shadow" style="padding:1em;">
					<div id="map_canvas_2" style="height:300px;"></div>
				</div>
			</div>
		</div>

		<div data-title="Found Trail Magic" id="found_trail_magic" data-role="page">
			<div data-role="header" data-add-back-btn="true">
				<h1>Found Trail Magic</h1>
				<a href="index.html" data-ajax="false" data-icon="home">Home</a>
			</div>
			<div data-role="content">
				<form action="form.php" method="post">
					<h1>What's in it?</h1>
					<div data-role="fieldcontain">
						<input type="text" name="name" id="name" value="" placeholder="Cooler of Cokes"  />
						<button type="submit" data-theme="b" name="submit" value="submit-value">Submit</button>
					</div>
				</form>
			</div>
		</div>

		<div data-title="Find a Hotel" id="find_a_hotel" data-role="page">
			<div data-role="header" data-add-back-btn="true">
				<h1>Find a Hotel</h1>
				<a href="index.html" data-ajax="false" data-icon="home">Home</a>
			</div>
			<div data-role="content">
				<div class="ui-bar-c ui-corner-all ui-shadow" style="padding:1em;">
					<div id="map_canvas_3" style="height:300px;"></div>
				</div>
			</div>
		</div>

  </body>
</html>
